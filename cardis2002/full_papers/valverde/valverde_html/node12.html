<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.2beta8 (1.43)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The operation xtime</TITLE>
<META NAME="description" CONTENT="The operation xtime">
<META NAME="keywords" CONTENT="aes_on_crypto2000">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(n,e,t){function r(t){if(!e[t]){var o=e[t]={exports:{}};n[t][0].call(o.exports,function(e){var o=n[t][1][e];return r(o?o:e)},o,o.exports)}return e[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({QJf3ax:[function(n,e){function t(n){function e(e,t,a){n&&n(e,t,a),a||(a={});for(var u=c(e),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,t);return s}function a(n,e){f[n]=c(n).concat(e)}function c(n){return f[n]||[]}function u(){return t(e)}var f={};return{on:a,emit:e,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=n("gos");e.exports=t()},{gos:"7eSDFh"}],ee:[function(n,e){e.exports=n("QJf3ax")},{}],3:[function(n,e){function t(n){return function(){r(n,[(new Date).getTime()].concat(i(arguments)))}}var r=n("handle"),o=n(1),i=n(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(n,e){window.NREUM[e]=t("api-"+e)}),e.exports=window.NREUM},{1:12,2:13,handle:"D5DuLP"}],gos:[function(n,e){e.exports=n("7eSDFh")},{}],"7eSDFh":[function(n,e){function t(n,e,t){if(r.call(n,e))return n[e];var o=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(n,e,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return n[e]=o,o}var r=Object.prototype.hasOwnProperty;e.exports=t},{}],D5DuLP:[function(n,e){function t(n,e,t){return r.listeners(n).length?r.emit(n,e,t):(o[n]||(o[n]=[]),void o[n].push(e))}var r=n("ee").create(),o={};e.exports=t,t.ee=r,r.q=o},{ee:"QJf3ax"}],handle:[function(n,e){e.exports=n("D5DuLP")},{}],XL7HBI:[function(n,e){function t(n){var e=typeof n;return!n||"object"!==e&&"function"!==e?-1:n===window?0:i(n,o,function(){return r++})}var r=1,o="nr@id",i=n("gos");e.exports=t},{gos:"7eSDFh"}],id:[function(n,e){e.exports=n("XL7HBI")},{}],loader:[function(n,e){e.exports=n("G9z0Bl")},{}],G9z0Bl:[function(n,e){function t(){var n=h.info=NREUM.info;if(n&&n.licenseKey&&n.applicationID&&f&&f.body){c(l,function(e,t){e in n||(n[e]=t)}),h.proto="https"===d.split(":")[0]||n.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var e=f.createElement("script");e.src=h.proto+n.agent,f.body.appendChild(e)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=n("handle"),c=n(1),u=(n(2),window),f=u.document,s="addEventListener",p="attachEvent",d=(""+location).split("?")[0],l={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-593.min.js"},h=e.exports={offset:i(),origin:d,features:{}};f[s]?(f[s]("DOMContentLoaded",o,!1),u[s]("load",t,!1)):(f[p]("onreadystatechange",r),u[p]("onload",t)),a("mark",["firstbyte",i()])},{1:12,2:3,handle:"D5DuLP"}],12:[function(n,e){function t(n,e){var t=[],o="",i=0;for(o in n)r.call(n,o)&&(t[i]=e(o,n[o]),i+=1);return t}var r=Object.prototype.hasOwnProperty;e.exports=t},{}],13:[function(n,e){function t(n,e,t){e||(e=0),"undefined"==typeof t&&(t=n?n.length:0);for(var r=-1,o=t-e||0,i=Array(0>o?0:o);++r<o;)i[r]=n[e+r];return i}e.exports=t},{}]},{},["G9z0Bl"]);</script>
<META NAME="Generator" CONTENT="LaTeX2HTML v99.2beta8">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="aes_on_crypto2000.css">

<LINK REL="previous" HREF="node11.html">
<LINK REL="up" HREF="node7.html">
<LINK REL="next" HREF="node13.html">
</HEAD>

<a href="http://www.usenix.org"><img src="../../../../../../graphics/new_usenix.jpg" width="288" height="232" alt="Check out the new USENIX Web site." align="right"></a>


<BODY >
<!--Navigation Panel-->
<A NAME="tex2html153"
  HREF="node13.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html151"
  HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html147"
  HREF="node11.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/lib/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html154"
  HREF="node13.html">The public-key coprocessor based</A>
<B> Up:</B> <A NAME="tex2html152"
  HREF="node7.html">Description of the Advanced</A>
<B> Previous:</B> <A NAME="tex2html148"
  HREF="node11.html">The transformation MixColumn</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H4><A NAME="SECTION00030050000000000000">
The operation <TT>xtime</TT></A>
</H4>

The multiplications in <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$"> necessary to compute the
transformation <!-- MATH
 $\text{\tt MixColumn}$
 -->
<TT>MixColumn</TT> are of great importance to our implementation.
Therefore we are going to describe them in more detail. First we need
to say a few words about the representation of the field <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$">. In AES 
the field <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$"> is represented as
<BR>
<DIV ALIGN="CENTER"><A NAME="fz8"></A><!-- MATH
 \begin{eqnarray}
\mathbb{F}_{2^{8}}=\mathbb{F}_2[x]/(x^8+x^4+x^3+x+1).
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="253" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img55.png"
 ALT="$\displaystyle \mathbb{F}_{2^{8}}=\mathbb{F}_2[x]/(x^8+x^4+x^3+x+1).$"></TD>
<TD>&nbsp;</TD>
<TD>&nbsp;</TD>
<TD WIDTH=10 ALIGN="RIGHT">
(2)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
That is, elements of <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$"> are polynomials over <!-- MATH
 $\mathbb{F}_2$
 -->
<IMG
 WIDTH="23" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img56.png"
 ALT="$ \mathbb{F}_2$"> of degree
at most <IMG
 WIDTH="14" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img57.png"
 ALT="$ 7$">. The addition and multiplication of two polynomials is
done modulo the polynomial <!-- MATH
 $x^8+x^4+x^3+x+1$
 -->
<IMG
 WIDTH="150" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img58.png"
 ALT="$ x^8+x^4+x^3+x+1$">. Since this is an
irreducible polynomial over <!-- MATH
 $\mathbb{F}_2$
 -->
<IMG
 WIDTH="23" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img56.png"
 ALT="$ \mathbb{F}_2$">,&nbsp;(<A HREF="node12.html#fz8">2</A>) defines a field.
In this representation of <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$"> the byte <!-- MATH
 ${\bf a}=(a_7,\ldots, a_1,a_0)$
 -->
<IMG
 WIDTH="138" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img59.png"
 ALT="$ {\bf a}=(a_7,\ldots, a_1,a_0)$"> corresponds to the
polynomial <!-- MATH
 $a_7x^7+\cdots a_1 x+a_0$
 -->
<IMG
 WIDTH="138" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img60.png"
 ALT="$ a_7x^7+\cdots a_1 x+a_0$">.
The multiplication of an element <!-- MATH
 ${\bf a}=(a_7,\ldots, a_1,a_0)$
 -->
<IMG
 WIDTH="138" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img59.png"
 ALT="$ {\bf a}=(a_7,\ldots, a_1,a_0)$"> in <!-- MATH
 $\mathbb{F}_{2^{8}}$
 -->
<IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.png"
 ALT="$ \mathbb{F}_{2^{8}}$">
by <IMG
 WIDTH="45" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img49.png"
 ALT="$ 01,02$">, and <IMG
 WIDTH="22" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img50.png"
 ALT="$ 03$"> is realized by multiplying the 
polynomial <!-- MATH
 $a_7x^7+\cdots a_1 x+a_0$
 -->
<IMG
 WIDTH="138" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img60.png"
 ALT="$ a_7x^7+\cdots a_1 x+a_0$"> with the polynomials <IMG
 WIDTH="74" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.png"
 ALT="$ 1, x, x+1$">, respectively, and 
reducing the result modulo <!-- MATH
 $x^8+x^4+x^3+x+1$
 -->
<IMG
 WIDTH="150" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img58.png"
 ALT="$ x^8+x^4+x^3+x+1$">. Hence 
<BR>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{eqnarray*}
01\cdot {\bf a} &=&  {\bf a}\\
03\cdot {\bf a} &= &02\cdot {\bf a}+{\bf a}.
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="42" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img62.png"
 ALT="$\displaystyle 01\cdot {\bf a}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img63.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="15" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img64.png"
 ALT="$\displaystyle {\bf a}$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="42" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img65.png"
 ALT="$\displaystyle 03\cdot {\bf a}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img63.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="75" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img66.png"
 ALT="$\displaystyle 02\cdot {\bf a}+{\bf a}.$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
We see that the only non-trivial multiplication needed to multiply a
column of a state by the matrix in (<A HREF="node11.html#mc-matrix">1</A>) is the
multiplication by <IMG
 WIDTH="22" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img67.png"
 ALT="$ 02$">. Following the notation in [<A
 HREF="node21.html#DR2">DR2</A>] we denote
the multiplication of byte <IMG
 WIDTH="15" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img68.png"
 ALT="$ {\bf a}$"> by <IMG
 WIDTH="22" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img67.png"
 ALT="$ 02$"> by <!-- MATH
 ${\tt xtime}({\bf a})$
 -->
<IMG
 WIDTH="69" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img69.png"
 ALT="$ {\tt xtime}({\bf a})$">. The crucial
observation is that <!-- MATH
 ${\tt xtime}({\bf a})$
 -->
<IMG
 WIDTH="69" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img69.png"
 ALT="$ {\tt xtime}({\bf a})$"> is simply a shift of byte <IMG
 WIDTH="15" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img68.png"
 ALT="$ {\bf a}$">, followed
in some cases by an xor of two bytes. More precisely, for <!-- MATH
 ${\bf a}=(a_7,\ldots ,a_0)$
 -->
<IMG
 WIDTH="115" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img70.png"
 ALT="$ {\bf a}=(a_7,\ldots ,a_0)$">
<BR>
<DIV ALIGN="CENTER"><A NAME="opxt"></A><!-- MATH
 \begin{eqnarray*}
\begin{array}{l}
{\tt xtime}({\bf a})=\left\{\begin{array}{ll}
(a_6,\ldots,a_0,0), & \\
\quad \textrm{if $a_7 = 0$}\\
\\
(a_6,\ldots,a_0,0)\oplus (0,0,0,1,1,0,1,1), & \\
\quad \textrm{if $a_7=1$}
\end{array}\right.
\end{array}
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="443" HEIGHT="112" BORDER="0"
 SRC="img71.png"
 ALT="\begin{displaymath}\begin{array}{l}
{\tt xtime}({\bf a})=\left\{\begin{array}{ll...
... &amp; \\
\quad \textrm{if $a_7=1$}
\end{array}\right.
\end{array}\end{displaymath}"></TD>
<TD>&nbsp;</TD>
<TD>&nbsp;</TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This finishes our brief description of the AES encryption procedure.

In a pure software implementation of the algorithm on an 8051 based <IMG
 WIDTH="16" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ \mu$">-controller these transformations are 
performed one after the other within the CPU using 48 bytes of directly addressable internal RAM, 
and taking roughly 12000 clock cycles to encrypt a 128 bit data block with a 128-bit key. 
The decryption algorithm takes about 30% more time than the cipher and 
requires at least the same bytes of internal RAM resources. 
This is due to the fact that the software implementation of the inverse <!-- MATH
 $\text{\tt MixColumn}$
 -->
<TT>MixColumn</TT> transformation 
used for decryption is less efficient than the <!-- MATH
 $\text{\tt MixColumn}$
 -->
<TT>MixColumn</TT> transformation used for encryption.

<HR>
<!--Navigation Panel-->
<A NAME="tex2html153"
  HREF="node13.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html151"
  HREF="node7.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html147"
  HREF="node11.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/lib/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html154"
  HREF="node13.html">The public-key coprocessor based</A>
<B> Up:</B> <A NAME="tex2html152"
  HREF="node7.html">Description of the Advanced</A>
<B> Previous:</B> <A NAME="tex2html148"
  HREF="node11.html">The transformation MixColumn</A>
<!--End of Navigation Panel-->
<ADDRESS>
Roger Fischlin
2002-09-25
</ADDRESS>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"d823139095","applicationID":"509444","transactionName":"YVJVZksCXkEEVhIMWFgYdlFNCl9cSkAVAFlfT2hAXAdZQABWEhZoWFhDbV8MRVwB","queueTime":0,"applicationTime":98,"ttGuid":"","agentToken":"","atts":"TRVWEAMYTU8=","errorBeacon":"bam.nr-data.net","agent":"js-agent.newrelic.com\/nr-593.min.js"}</script></BODY>
</HTML>
