<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2K.1beta (1.47)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Example</TITLE>
<META NAME="description" CONTENT="Example">
<META NAME="keywords" CONTENT="paper">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({QJf3ax:[function(t,e){function n(t){function e(e,n,a){t&&t(e,n,a),a||(a={});for(var c=u(e),f=c.length,s=i(a,o,r),p=0;f>p;p++)c[p].apply(s,n);return s}function a(t,e){f[t]=u(t).concat(e)}function u(t){return f[t]||[]}function c(){return n(e)}var f={};return{on:a,emit:e,create:c,listeners:u,_events:f}}function r(){return{}}var o="nr@context",i=t("gos");e.exports=n()},{gos:"7eSDFh"}],ee:[function(t,e){e.exports=t("QJf3ax")},{}],gos:[function(t,e){e.exports=t("7eSDFh")},{}],"7eSDFh":[function(t,e){function n(t,e,n){if(r.call(t,e))return t[e];var o=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return t[e]=o,o}var r=Object.prototype.hasOwnProperty;e.exports=n},{}],D5DuLP:[function(t,e){function n(t,e,n){return r.listeners(t).length?r.emit(t,e,n):(o[t]||(o[t]=[]),void o[t].push(e))}var r=t("ee").create(),o={};e.exports=n,n.ee=r,r.q=o},{ee:"QJf3ax"}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],XL7HBI:[function(t,e){function n(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:i(t,o,function(){return r++})}var r=1,o="nr@id",i=t("gos");e.exports=n},{gos:"7eSDFh"}],id:[function(t,e){e.exports=t("XL7HBI")},{}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],G9z0Bl:[function(t,e){function n(){var t=l.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&c&&c.body){l.proto="https"===p.split(":")[0]||t.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var e=c.createElement("script");e.src=l.proto+t.agent,c.body.appendChild(e)}}function r(){"complete"===c.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),u=window,c=u.document,f="addEventListener",s="attachEvent",p=(""+location).split("?")[0],l=e.exports={offset:i(),origin:p,features:{}};c[f]?(c[f]("DOMContentLoaded",o,!1),u[f]("load",n,!1)):(c[s]("onreadystatechange",r),u[s]("onload",n)),a("mark",["firstbyte",i()])},{handle:"D5DuLP"}]},{},["G9z0Bl"]);</script>
<META NAME="Generator" CONTENT="LaTeX2HTML v2K.1beta">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="paper.css">

<LINK REL="next" HREF="node18.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="up" HREF="index.html">
<LINK REL="next" HREF="node10.html">
</HEAD>

<a href="http://www.usenix.org"><img src="../../../../../../graphics/new_usenix.jpg" width="288" height="232" alt="Check out the new USENIX Web site." align="right"></a>


<BODY >
<!--Navigation Panel-->
<A NAME="tex2html119"
  HREF="node10.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html117"
  HREF="index.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html111"
  HREF="node8.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html120"
  HREF="node10.html">Example Properties</A>
<B> Up:</B> <A NAME="tex2html118"
  HREF="index.html">Model Checking of Multi-Applet</A>
<B> Previous:</B> <A NAME="tex2html112"
  HREF="node8.html">A Tool for Model</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00040000000000000000"></A>
<A NAME="sect:example"></A>
<BR>
Example
</H1>

<P>
The model checking of JavaCard applets will be illustrated
with an example; a modification of the 
purse example from SUN's JavaCard Development Kit (version 2.1.2).
This example is a prototypical purse and loyalty smartcard
application, which comprises around 1430 lines of JavaCard code.

<P>
To understand the example it is helpful to recall the
execution characteristics of JavaCard applets (language version 2.1.1).
An interaction with the card (after installation of an applet,
and its selection) is initiated through calling its <code>process</code>
method. Inter-applet communications, crossing package borders,
are controlled by the JavaCard firewall mechanism and
take place through special interface objects.
The methods of such interface objects 
are indicated in Figure&nbsp;<A HREF="node9.html#fig:purse">1</A>.

<P>

<P></P>
<DIV ALIGN="CENTER"><A NAME="fig:purse"></A><A NAME="598"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 1:</STRONG>
Purse Class Diagram</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
<!-- MATH
 $\resizebox{9cm}{7cm}{\includegraphics{purse}}$
 -->
<IMG
 WIDTH="405" HEIGHT="314" ALIGN="BOTTOM" BORDER="0"
 SRC="img111.png"
 ALT="\resizebox{9cm}{7cm}{\includegraphics{purse}}">
</DIV></TD></TR>
</TABLE>
</DIV><P></P>

<P>
The purse applet keeps a balance that is updated upon requests
from the environment.
Purse transactions, whether successful or not, are logged to
a transaction log. 
The operations of updating the balance, logging the new transaction
and updating the transaction number are made atomic through
use of the transaction facility of JavaCard.

<P>
Upon completion of a new purse transaction the purse applet
notifies subsidiary loyalty applets via the interface
method <code>grantPoints</code>. 
These are applets that should
be notified of the balance update so that they,
for example, can award loyalty points. 
A concrete example is a bank smartcard with an embedded
loyalty applet for a car rental company that awards bonus
points for every car rented using the bank card.

<P>
In addition to these functionalities there are methods,
accessible through the <code>process</code> method of the applet,
for modifying most of the parameters of the purse applet,
including adding knowledge about new loyalty applets
that should be notified when card transactions occur.

<P>
The loyalty applets
of the Development Kit purse application do
not attempt to communicate with other applets.
We have extended the example loyalty applet with
two new functionalities:
(i) A loyalty applet can have agreements with other loyalty
applets to share bonus points; to achieve this we
introduce direct loyalty applet to loyalty applet communication
using the interface method <code>grantLoyaltyPoints</code>.
(ii) loyalty applets can have an agreement with the purse
to transfer, according to same fixed rate, part of the
bonus points back to the purse. 
This is achieved through calling the interface
method <code>bonusPointsToPurse</code> of the purse.

<P>
The modified purse and loyalties 
example is a rewarding example to study
using our model checking approach as many key applet
correctness properties can be phrased as
properties of inter-applet communications.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html121"
  HREF="node10.html">Example Properties</A>
<UL>
<LI><A NAME="tex2html122"
  HREF="node11.html">Property 1: there are no calls to both
grantPoints and grantLoyaltyPoints for the same applet.</A>
<LI><A NAME="tex2html123"
  HREF="node12.html">Property 2: grantPoints is not transitive.</A>
<LI><A NAME="tex2html124"
  HREF="node13.html">Property 3: grantLoyaltyPoints is not transitive.</A>
<LI><A NAME="tex2html125"
  HREF="node14.html">Property 4: grantLoyaltyPoints is called only through
grantPoints.</A>
<LI><A NAME="tex2html126"
  HREF="node15.html">Property 5: Bonus point are awarded at most once within a transaction.</A>
<LI><A NAME="tex2html127"
  HREF="node16.html">Property 6: no constructors called.</A>
<LI><A NAME="tex2html128"
  HREF="node17.html">Property 7: recursion freeness.</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html119"
  HREF="node10.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html117"
  HREF="index.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html111"
  HREF="node8.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html120"
  HREF="node10.html">Example Properties</A>
<B> Up:</B> <A NAME="tex2html118"
  HREF="index.html">Model Checking of Multi-Applet</A>
<B> Previous:</B> <A NAME="tex2html112"
  HREF="node8.html">A Tool for Model</A>
<!--End of Navigation Panel-->
<ADDRESS>
Lars-Ake Fredlund
2002-09-23
</ADDRESS>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"beacon-1.newrelic.com","licenseKey":"d823139095","applicationID":"509444","transactionName":"YVJVZksCXkEEVhIMWFgYdlFNCl9cSkAVAFlfT2hAXAdZQABWEhZoWFhDbV8MRVwB","queueTime":0,"applicationTime":77,"ttGuid":"","agentToken":"","atts":"TRVWEAMYTU8=","errorBeacon":"bam.nr-data.net","agent":"js-agent.newrelic.com\/nr-476.min.js"}</script></BODY>
</HTML>
